{"mappings":"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","sources":["node_modules/@swc/helpers/src/_define_property.js","node_modules/@swc/helpers/src/_object_spread.js","node_modules/@swc/helpers/src/_to_consumable_array.js","node_modules/@swc/helpers/src/_array_without_holes.js","node_modules/@swc/helpers/src/_iterable_to_array.js","node_modules/@swc/helpers/src/_non_iterable_spread.js","node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-34db8a279ab0be9e.js","node_modules/webrtc-adapter/src/js/utils.js","node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","node_modules/webrtc-adapter/src/js/edge/edge_shim.js","node_modules/sdp/sdp.js","node_modules/webrtc-adapter/src/js/edge/getusermedia.js","node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","node_modules/webrtc-adapter/src/js/safari/safari_shim.js","node_modules/webrtc-adapter/src/js/adapter_core.js","node_modules/getusermedia/getusermedia.js","node_modules/@epok.tech/gl-screen-triangle/index.js","node_modules/@epok.tech/fn-lists/range.js","node_modules/@epok.tech/fn-lists/reduce.js","node_modules/@epok.tech/fn-lists/map.js","node_modules/@epok.tech/fn-lists/each.js","node_modules/@epok.tech/fn-lists/wrap-index.js","index.frag.glsl","demo/spread.frag.glsl","demo/view.frag.glsl","demo/index.js","node_modules/@epok.tech/gl-screen-triangle/uv-texture.vert.glsl","node_modules/@parcel/runtime-js/lib/helpers/bundle-url.js","node_modules/@parcel/runtime-js/lib/runtime-de7d77c413967e53.js"],"sourcesContent":["export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n","import defineProperty from './_define_property';\n\nexport default function _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}","import arrayWithoutHoles from './_array_without_holes';\nimport iterableToArray from './_iterable_to_array';\nimport nonIterableSpread from './_non_iterable_spread';\n\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}\n","export default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n","export default function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n","\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"7P4AG\\\":\\\"index.3749c18b.js\\\",\\\"5El74\\\":\\\"sample.6124211c.mp4\\\"}\"));","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar logDisabled_ = true;\n\n// Utility methods.\nvar utils = {\n  disableLog: function(bool) {\n    if (typeof bool !== 'boolean') {\n      return new Error('Argument type: ' + typeof bool +\n          '. Please use a boolean.');\n    }\n    logDisabled_ = bool;\n    return (bool) ? 'adapter.js logging disabled' :\n        'adapter.js logging enabled';\n  },\n\n  log: function() {\n    if (typeof window === 'object') {\n      if (logDisabled_) {\n        return;\n      }\n      if (typeof console !== 'undefined' && typeof console.log === 'function') {\n        console.log.apply(console, arguments);\n      }\n    }\n  },\n\n  /**\n   * Extract browser version out of the provided user agent string.\n   *\n   * @param {!string} uastring userAgent string.\n   * @param {!string} expr Regular expression used as match criteria.\n   * @param {!number} pos position in the version string to be returned.\n   * @return {!number} browser version.\n   */\n  extractVersion: function(uastring, expr, pos) {\n    var match = uastring.match(expr);\n    return match && match.length >= pos && parseInt(match[pos], 10);\n  },\n\n  /**\n   * Browser detector.\n   *\n   * @return {object} result containing browser and version\n   *     properties.\n   */\n  detectBrowser: function() {\n    // Returned result object.\n    var result = {};\n    result.browser = null;\n    result.version = null;\n\n    // Fail early if it's not a browser\n    if (typeof window === 'undefined' || !window.navigator) {\n      result.browser = 'Not a browser.';\n      return result;\n    }\n\n    // Firefox.\n    if (navigator.mozGetUserMedia) {\n      result.browser = 'firefox';\n      result.version = this.extractVersion(navigator.userAgent,\n          /Firefox\\/([0-9]+)\\./, 1);\n\n    // all webkit-based browsers\n    } else if (navigator.webkitGetUserMedia) {\n      // Chrome, Chromium, Webview, Opera, all use the chrome shim for now\n      if (window.webkitRTCPeerConnection) {\n        result.browser = 'chrome';\n        result.version = this.extractVersion(navigator.userAgent,\n          /Chrom(e|ium)\\/([0-9]+)\\./, 2);\n\n      // Safari or unknown webkit-based\n      // for the time being Safari has support for MediaStreams but not webRTC\n      } else {\n        // Safari UA substrings of interest for reference:\n        // - webkit version:           AppleWebKit/602.1.25 (also used in Op,Cr)\n        // - safari UI version:        Version/9.0.3 (unique to Safari)\n        // - safari UI webkit version: Safari/601.4.4 (also used in Op,Cr)\n        //\n        // if the webkit version and safari UI webkit versions are equals,\n        // ... this is a stable version.\n        //\n        // only the internal webkit version is important today to know if\n        // media streams are supported\n        //\n        if (navigator.userAgent.match(/Version\\/(\\d+).(\\d+)/)) {\n          result.browser = 'safari';\n          result.version = this.extractVersion(navigator.userAgent,\n            /AppleWebKit\\/([0-9]+)\\./, 1);\n\n        // unknown webkit-based browser\n        } else {\n          result.browser = 'Unsupported webkit-based browser ' +\n              'with GUM support but no WebRTC support.';\n          return result;\n        }\n      }\n\n    // Edge.\n    } else if (navigator.mediaDevices &&\n        navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\n      result.browser = 'edge';\n      result.version = this.extractVersion(navigator.userAgent,\n          /Edge\\/(\\d+).(\\d+)$/, 2);\n\n    // Default fallthrough: not supported.\n    } else {\n      result.browser = 'Not a supported browser.';\n      return result;\n    }\n\n    return result;\n  }\n};\n\n// Export.\nmodule.exports = {\n  log: utils.log,\n  disableLog: utils.disableLog,\n  browserDetails: utils.detectBrowser(),\n  extractVersion: utils.extractVersion\n};\n","\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nvar logging = require('../utils.js').log;\nvar browserDetails = require('../utils.js').browserDetails;\n\nvar chromeShim = {\n  shimMediaStream: function() {\n    window.MediaStream = window.MediaStream || window.webkitMediaStream;\n  },\n\n  shimOnTrack: function() {\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n        window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function() {\n          return this._ontrack;\n        },\n        set: function(f) {\n          var self = this;\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n            this.removeEventListener('addstream', this._ontrackpoly);\n          }\n          this.addEventListener('track', this._ontrack = f);\n          this.addEventListener('addstream', this._ontrackpoly = function(e) {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', function(te) {\n              var event = new Event('track');\n              event.track = te.track;\n              event.receiver = {track: te.track};\n              event.streams = [e.stream];\n              self.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(function(track) {\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = {track: track};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            }.bind(this));\n          }.bind(this));\n        }\n      });\n    }\n  },\n\n  shimSourceObject: function() {\n    if (typeof window === 'object') {\n      if (window.HTMLMediaElement &&\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n          get: function() {\n            return this._srcObject;\n          },\n          set: function(stream) {\n            var self = this;\n            // Use _srcObject as a private property for this shim\n            this._srcObject = stream;\n            if (this.src) {\n              URL.revokeObjectURL(this.src);\n            }\n\n            if (!stream) {\n              this.src = '';\n              return;\n            }\n            this.src = URL.createObjectURL(stream);\n            // We need to recreate the blob url when a track is added or\n            // removed. Doing it manually since we want to avoid a recursion.\n            stream.addEventListener('addtrack', function() {\n              if (self.src) {\n                URL.revokeObjectURL(self.src);\n              }\n              self.src = URL.createObjectURL(stream);\n            });\n            stream.addEventListener('removetrack', function() {\n              if (self.src) {\n                URL.revokeObjectURL(self.src);\n              }\n              self.src = URL.createObjectURL(stream);\n            });\n          }\n        });\n      }\n    }\n  },\n\n  shimPeerConnection: function() {\n    // The RTCPeerConnection object.\n    window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n      // Translate iceTransportPolicy to iceTransports,\n      // see https://code.google.com/p/webrtc/issues/detail?id=4869\n      logging('PeerConnection');\n      if (pcConfig && pcConfig.iceTransportPolicy) {\n        pcConfig.iceTransports = pcConfig.iceTransportPolicy;\n      }\n\n      var pc = new webkitRTCPeerConnection(pcConfig, pcConstraints);\n      var origGetStats = pc.getStats.bind(pc);\n      pc.getStats = function(selector, successCallback, errorCallback) {\n        var self = this;\n        var args = arguments;\n\n        // If selector is a function then we are in the old style stats so just\n        // pass back the original getStats format to avoid breaking old users.\n        if (arguments.length > 0 && typeof selector === 'function') {\n          return origGetStats(selector, successCallback);\n        }\n\n        var fixChromeStats_ = function(response) {\n          var standardReport = {};\n          var reports = response.result();\n          reports.forEach(function(report) {\n            var standardStats = {\n              id: report.id,\n              timestamp: report.timestamp,\n              type: report.type\n            };\n            report.names().forEach(function(name) {\n              standardStats[name] = report.stat(name);\n            });\n            standardReport[standardStats.id] = standardStats;\n          });\n\n          return standardReport;\n        };\n\n        // shim getStats with maplike support\n        var makeMapStats = function(stats, legacyStats) {\n          var map = new Map(Object.keys(stats).map(function(key) {\n            return[key, stats[key]];\n          }));\n          legacyStats = legacyStats || stats;\n          Object.keys(legacyStats).forEach(function(key) {\n            map[key] = legacyStats[key];\n          });\n          return map;\n        };\n\n        if (arguments.length >= 2) {\n          var successCallbackWrapper_ = function(response) {\n            args[1](makeMapStats(fixChromeStats_(response)));\n          };\n\n          return origGetStats.apply(this, [successCallbackWrapper_,\n              arguments[0]]);\n        }\n\n        // promise-support\n        return new Promise(function(resolve, reject) {\n          if (args.length === 1 && typeof selector === 'object') {\n            origGetStats.apply(self, [\n              function(response) {\n                resolve(makeMapStats(fixChromeStats_(response)));\n              }, reject]);\n          } else {\n            // Preserve legacy chrome stats only on legacy access of stats obj\n            origGetStats.apply(self, [\n              function(response) {\n                resolve(makeMapStats(fixChromeStats_(response),\n                    response.result()));\n              }, reject]);\n          }\n        }).then(successCallback, errorCallback);\n      };\n\n      return pc;\n    };\n    window.RTCPeerConnection.prototype = webkitRTCPeerConnection.prototype;\n\n    // wrap static methods. Currently just generateCertificate.\n    if (webkitRTCPeerConnection.generateCertificate) {\n      Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n        get: function() {\n          return webkitRTCPeerConnection.generateCertificate;\n        }\n      });\n    }\n\n    ['createOffer', 'createAnswer'].forEach(function(method) {\n      var nativeMethod = webkitRTCPeerConnection.prototype[method];\n      webkitRTCPeerConnection.prototype[method] = function() {\n        var self = this;\n        if (arguments.length < 1 || (arguments.length === 1 &&\n            typeof arguments[0] === 'object')) {\n          var opts = arguments.length === 1 ? arguments[0] : undefined;\n          return new Promise(function(resolve, reject) {\n            nativeMethod.apply(self, [resolve, reject, opts]);\n          });\n        }\n        return nativeMethod.apply(this, arguments);\n      };\n    });\n\n    // add promise support -- natively available in Chrome 51\n    if (browserDetails.version < 51) {\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n          .forEach(function(method) {\n            var nativeMethod = webkitRTCPeerConnection.prototype[method];\n            webkitRTCPeerConnection.prototype[method] = function() {\n              var args = arguments;\n              var self = this;\n              var promise = new Promise(function(resolve, reject) {\n                nativeMethod.apply(self, [args[0], resolve, reject]);\n              });\n              if (args.length < 2) {\n                return promise;\n              }\n              return promise.then(function() {\n                args[1].apply(null, []);\n              },\n              function(err) {\n                if (args.length >= 3) {\n                  args[2].apply(null, [err]);\n                }\n              });\n            };\n          });\n    }\n\n    // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          var nativeMethod = webkitRTCPeerConnection.prototype[method];\n          webkitRTCPeerConnection.prototype[method] = function() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                RTCIceCandidate : RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          };\n        });\n\n    // support for addIceCandidate(null or undefined)\n    var nativeAddIceCandidate =\n        RTCPeerConnection.prototype.addIceCandidate;\n    RTCPeerConnection.prototype.addIceCandidate = function() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n  }\n};\n\n\n// Expose public methods.\nmodule.exports = {\n  shimMediaStream: chromeShim.shimMediaStream,\n  shimOnTrack: chromeShim.shimOnTrack,\n  shimSourceObject: chromeShim.shimSourceObject,\n  shimPeerConnection: chromeShim.shimPeerConnection,\n  shimGetUserMedia: require('./getusermedia')\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nvar logging = require('../utils.js').log;\n\n// Expose public methods.\nmodule.exports = function() {\n  var constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    var cc = {};\n    Object.keys(c).forEach(function(key) {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      var r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      var oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        var oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(function(mix) {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  var shimConstraints_ = function(constraints, func) {\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && constraints.audio) {\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile, where it defaults to \"user\".\n      var face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode)) {\n        delete constraints.video.facingMode;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          // Look for \"back\" in label, or use last cam (typically back cam).\n          return navigator.mediaDevices.enumerateDevices()\n          .then(function(devices) {\n            devices = devices.filter(function(d) {\n              return d.kind === 'videoinput';\n            });\n            var back = devices.find(function(d) {\n              return d.label.toLowerCase().indexOf('back') !== -1;\n            }) || (devices.length && devices[devices.length - 1]);\n            if (back) {\n              constraints.video.deviceId = face.exact ? {exact: back.deviceId} :\n                                                        {ideal: back.deviceId};\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  var shimError_ = function(e) {\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraintName,\n      toString: function() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, function(c) {\n      navigator.webkitGetUserMedia(c, onSuccess, function(e) {\n        onError(shimError_(e));\n      });\n    });\n  };\n\n  navigator.getUserMedia = getUserMedia_;\n\n  // Returns the result of getUserMedia as a Promise.\n  var getUserMediaPromise_ = function(constraints) {\n    return new Promise(function(resolve, reject) {\n      navigator.getUserMedia(constraints, resolve, reject);\n    });\n  };\n\n  if (!navigator.mediaDevices) {\n    navigator.mediaDevices = {\n      getUserMedia: getUserMediaPromise_,\n      enumerateDevices: function() {\n        return new Promise(function(resolve) {\n          var kinds = {audio: 'audioinput', video: 'videoinput'};\n          return MediaStreamTrack.getSources(function(devices) {\n            resolve(devices.map(function(device) {\n              return {label: device.label,\n                      kind: kinds[device.kind],\n                      deviceId: device.id,\n                      groupId: ''};\n            }));\n          });\n        });\n      }\n    };\n  }\n\n  // A shim for getUserMedia method on the mediaDevices object.\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\n  if (!navigator.mediaDevices.getUserMedia) {\n    navigator.mediaDevices.getUserMedia = function(constraints) {\n      return getUserMediaPromise_(constraints);\n    };\n  } else {\n    // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n    // function which returns a Promise, it does not accept spec-style\n    // constraints.\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, function(c) {\n        return origGetUserMedia(c).then(function(stream) {\n          if (c.audio && !stream.getAudioTracks().length ||\n              c.video && !stream.getVideoTracks().length) {\n            stream.getTracks().forEach(function(track) {\n              track.stop();\n            });\n            throw new DOMException('', 'NotFoundError');\n          }\n          return stream;\n        }, function(e) {\n          return Promise.reject(shimError_(e));\n        });\n      });\n    };\n  }\n\n  // Dummy devicechange event methods.\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\n  if (typeof navigator.mediaDevices.addEventListener === 'undefined') {\n    navigator.mediaDevices.addEventListener = function() {\n      logging('Dummy mediaDevices.addEventListener called.');\n    };\n  }\n  if (typeof navigator.mediaDevices.removeEventListener === 'undefined') {\n    navigator.mediaDevices.removeEventListener = function() {\n      logging('Dummy mediaDevices.removeEventListener called.');\n    };\n  }\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\nvar browserDetails = require('../utils').browserDetails;\n\nvar edgeShim = {\n  shimPeerConnection: function() {\n    if (window.RTCIceGatherer) {\n      // ORTC defines an RTCIceCandidate object but no constructor.\n      // Not implemented in Edge.\n      if (!window.RTCIceCandidate) {\n        window.RTCIceCandidate = function(args) {\n          return args;\n        };\n      }\n      // ORTC does not have a session description object but\n      // other browsers (i.e. Chrome) that will support both PC and ORTC\n      // in the future might have this defined already.\n      if (!window.RTCSessionDescription) {\n        window.RTCSessionDescription = function(args) {\n          return args;\n        };\n      }\n      // this adds an additional event listener to MediaStrackTrack that signals\n      // when a tracks enabled property was changed.\n      var origMSTEnabled = Object.getOwnPropertyDescriptor(\n          MediaStreamTrack.prototype, 'enabled');\n      Object.defineProperty(MediaStreamTrack.prototype, 'enabled', {\n        set: function(value) {\n          origMSTEnabled.set.call(this, value);\n          var ev = new Event('enabled');\n          ev.enabled = value;\n          this.dispatchEvent(ev);\n        }\n      });\n    }\n\n    window.RTCPeerConnection = function(config) {\n      var self = this;\n\n      var _eventTarget = document.createDocumentFragment();\n      ['addEventListener', 'removeEventListener', 'dispatchEvent']\n          .forEach(function(method) {\n            self[method] = _eventTarget[method].bind(_eventTarget);\n          });\n\n      this.onicecandidate = null;\n      this.onaddstream = null;\n      this.ontrack = null;\n      this.onremovestream = null;\n      this.onsignalingstatechange = null;\n      this.oniceconnectionstatechange = null;\n      this.onnegotiationneeded = null;\n      this.ondatachannel = null;\n\n      this.localStreams = [];\n      this.remoteStreams = [];\n      this.getLocalStreams = function() {\n        return self.localStreams;\n      };\n      this.getRemoteStreams = function() {\n        return self.remoteStreams;\n      };\n\n      this.localDescription = new RTCSessionDescription({\n        type: '',\n        sdp: ''\n      });\n      this.remoteDescription = new RTCSessionDescription({\n        type: '',\n        sdp: ''\n      });\n      this.signalingState = 'stable';\n      this.iceConnectionState = 'new';\n      this.iceGatheringState = 'new';\n\n      this.iceOptions = {\n        gatherPolicy: 'all',\n        iceServers: []\n      };\n      if (config && config.iceTransportPolicy) {\n        switch (config.iceTransportPolicy) {\n          case 'all':\n          case 'relay':\n            this.iceOptions.gatherPolicy = config.iceTransportPolicy;\n            break;\n          case 'none':\n            // FIXME: remove once implementation and spec have added this.\n            throw new TypeError('iceTransportPolicy \"none\" not supported');\n          default:\n            // don't set iceTransportPolicy.\n            break;\n        }\n      }\n      this.usingBundle = config && config.bundlePolicy === 'max-bundle';\n\n      if (config && config.iceServers) {\n        // Edge does not like\n        // 1) stun:\n        // 2) turn: that does not have all of turn:host:port?transport=udp\n        // 3) turn: with ipv6 addresses\n        var iceServers = JSON.parse(JSON.stringify(config.iceServers));\n        this.iceOptions.iceServers = iceServers.filter(function(server) {\n          if (server && server.urls) {\n            var urls = server.urls;\n            if (typeof urls === 'string') {\n              urls = [urls];\n            }\n            urls = urls.filter(function(url) {\n              return (url.indexOf('turn:') === 0 &&\n                  url.indexOf('transport=udp') !== -1 &&\n                  url.indexOf('turn:[') === -1) ||\n                  (url.indexOf('stun:') === 0 &&\n                    browserDetails.version >= 14393);\n            })[0];\n            return !!urls;\n          }\n          return false;\n        });\n      }\n      this._config = config;\n\n      // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n      // everything that is needed to describe a SDP m-line.\n      this.transceivers = [];\n\n      // since the iceGatherer is currently created in createOffer but we\n      // must not emit candidates until after setLocalDescription we buffer\n      // them in this array.\n      this._localIceCandidatesBuffer = [];\n    };\n\n    window.RTCPeerConnection.prototype._emitBufferedCandidates = function() {\n      var self = this;\n      var sections = SDPUtils.splitSections(self.localDescription.sdp);\n      // FIXME: need to apply ice candidates in a way which is async but\n      // in-order\n      this._localIceCandidatesBuffer.forEach(function(event) {\n        var end = !event.candidate || Object.keys(event.candidate).length === 0;\n        if (end) {\n          for (var j = 1; j < sections.length; j++) {\n            if (sections[j].indexOf('\\r\\na=end-of-candidates\\r\\n') === -1) {\n              sections[j] += 'a=end-of-candidates\\r\\n';\n            }\n          }\n        } else if (event.candidate.candidate.indexOf('typ endOfCandidates')\n            === -1) {\n          sections[event.candidate.sdpMLineIndex + 1] +=\n              'a=' + event.candidate.candidate + '\\r\\n';\n        }\n        self.localDescription.sdp = sections.join('');\n        self.dispatchEvent(event);\n        if (self.onicecandidate !== null) {\n          self.onicecandidate(event);\n        }\n        if (!event.candidate && self.iceGatheringState !== 'complete') {\n          var complete = self.transceivers.every(function(transceiver) {\n            return transceiver.iceGatherer &&\n                transceiver.iceGatherer.state === 'completed';\n          });\n          if (complete) {\n            self.iceGatheringState = 'complete';\n          }\n        }\n      });\n      this._localIceCandidatesBuffer = [];\n    };\n\n    window.RTCPeerConnection.prototype.getConfiguration = function() {\n      return this._config;\n    };\n\n    window.RTCPeerConnection.prototype.addStream = function(stream) {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      this.localStreams.push(clonedStream);\n      this._maybeFireNegotiationNeeded();\n    };\n\n    window.RTCPeerConnection.prototype.removeStream = function(stream) {\n      var idx = this.localStreams.indexOf(stream);\n      if (idx > -1) {\n        this.localStreams.splice(idx, 1);\n        this._maybeFireNegotiationNeeded();\n      }\n    };\n\n    window.RTCPeerConnection.prototype.getSenders = function() {\n      return this.transceivers.filter(function(transceiver) {\n        return !!transceiver.rtpSender;\n      })\n      .map(function(transceiver) {\n        return transceiver.rtpSender;\n      });\n    };\n\n    window.RTCPeerConnection.prototype.getReceivers = function() {\n      return this.transceivers.filter(function(transceiver) {\n        return !!transceiver.rtpReceiver;\n      })\n      .map(function(transceiver) {\n        return transceiver.rtpReceiver;\n      });\n    };\n\n    // Determines the intersection of local and remote capabilities.\n    window.RTCPeerConnection.prototype._getCommonCapabilities =\n        function(localCapabilities, remoteCapabilities) {\n          var commonCapabilities = {\n            codecs: [],\n            headerExtensions: [],\n            fecMechanisms: []\n          };\n          localCapabilities.codecs.forEach(function(lCodec) {\n            for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n              var rCodec = remoteCapabilities.codecs[i];\n              if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n                  lCodec.clockRate === rCodec.clockRate) {\n                // number of channels is the highest common number of channels\n                rCodec.numChannels = Math.min(lCodec.numChannels,\n                    rCodec.numChannels);\n                // push rCodec so we reply with offerer payload type\n                commonCapabilities.codecs.push(rCodec);\n\n                // determine common feedback mechanisms\n                rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n                  for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n                    if (lCodec.rtcpFeedback[j].type === fb.type &&\n                        lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n                      return true;\n                    }\n                  }\n                  return false;\n                });\n                // FIXME: also need to determine .parameters\n                //  see https://github.com/openpeer/ortc/issues/569\n                break;\n              }\n            }\n          });\n\n          localCapabilities.headerExtensions\n              .forEach(function(lHeaderExtension) {\n                for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n                     i++) {\n                  var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n                  if (lHeaderExtension.uri === rHeaderExtension.uri) {\n                    commonCapabilities.headerExtensions.push(rHeaderExtension);\n                    break;\n                  }\n                }\n              });\n\n          // FIXME: fecMechanisms\n          return commonCapabilities;\n        };\n\n    // Create ICE gatherer, ICE transport and DTLS transport.\n    window.RTCPeerConnection.prototype._createIceAndDtlsTransports =\n        function(mid, sdpMLineIndex) {\n          var self = this;\n          var iceGatherer = new RTCIceGatherer(self.iceOptions);\n          var iceTransport = new RTCIceTransport(iceGatherer);\n          iceGatherer.onlocalcandidate = function(evt) {\n            var event = new Event('icecandidate');\n            event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n            var cand = evt.candidate;\n            var end = !cand || Object.keys(cand).length === 0;\n            // Edge emits an empty object for RTCIceCandidateComplete\n            if (end) {\n              // polyfill since RTCIceGatherer.state is not implemented in\n              // Edge 10547 yet.\n              if (iceGatherer.state === undefined) {\n                iceGatherer.state = 'completed';\n              }\n\n              // Emit a candidate with type endOfCandidates to make the samples\n              // work. Edge requires addIceCandidate with this empty candidate\n              // to start checking. The real solution is to signal\n              // end-of-candidates to the other side when getting the null\n              // candidate but some apps (like the samples) don't do that.\n              event.candidate.candidate =\n                  'candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates';\n            } else {\n              // RTCIceCandidate doesn't have a component, needs to be added\n              cand.component = iceTransport.component === 'RTCP' ? 2 : 1;\n              event.candidate.candidate = SDPUtils.writeCandidate(cand);\n            }\n\n            // update local description.\n            var sections = SDPUtils.splitSections(self.localDescription.sdp);\n            if (event.candidate.candidate.indexOf('typ endOfCandidates')\n                === -1) {\n              sections[event.candidate.sdpMLineIndex + 1] +=\n                  'a=' + event.candidate.candidate + '\\r\\n';\n            } else {\n              sections[event.candidate.sdpMLineIndex + 1] +=\n                  'a=end-of-candidates\\r\\n';\n            }\n            self.localDescription.sdp = sections.join('');\n\n            var complete = self.transceivers.every(function(transceiver) {\n              return transceiver.iceGatherer &&\n                  transceiver.iceGatherer.state === 'completed';\n            });\n\n            // Emit candidate if localDescription is set.\n            // Also emits null candidate when all gatherers are complete.\n            switch (self.iceGatheringState) {\n              case 'new':\n                self._localIceCandidatesBuffer.push(event);\n                if (end && complete) {\n                  self._localIceCandidatesBuffer.push(\n                      new Event('icecandidate'));\n                }\n                break;\n              case 'gathering':\n                self._emitBufferedCandidates();\n                self.dispatchEvent(event);\n                if (self.onicecandidate !== null) {\n                  self.onicecandidate(event);\n                }\n                if (complete) {\n                  self.dispatchEvent(new Event('icecandidate'));\n                  if (self.onicecandidate !== null) {\n                    self.onicecandidate(new Event('icecandidate'));\n                  }\n                  self.iceGatheringState = 'complete';\n                }\n                break;\n              case 'complete':\n                // should not happen... currently!\n                break;\n              default: // no-op.\n                break;\n            }\n          };\n          iceTransport.onicestatechange = function() {\n            self._updateConnectionState();\n          };\n\n          var dtlsTransport = new RTCDtlsTransport(iceTransport);\n          dtlsTransport.ondtlsstatechange = function() {\n            self._updateConnectionState();\n          };\n          dtlsTransport.onerror = function() {\n            // onerror does not set state to failed by itself.\n            dtlsTransport.state = 'failed';\n            self._updateConnectionState();\n          };\n\n          return {\n            iceGatherer: iceGatherer,\n            iceTransport: iceTransport,\n            dtlsTransport: dtlsTransport\n          };\n        };\n\n    // Start the RTP Sender and Receiver for a transceiver.\n    window.RTCPeerConnection.prototype._transceive = function(transceiver,\n        send, recv) {\n      var params = this._getCommonCapabilities(transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n      if (send && transceiver.rtpSender) {\n        params.encodings = transceiver.sendEncodingParameters;\n        params.rtcp = {\n          cname: SDPUtils.localCName\n        };\n        if (transceiver.recvEncodingParameters.length) {\n          params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n        }\n        transceiver.rtpSender.send(params);\n      }\n      if (recv && transceiver.rtpReceiver) {\n        // remove RTX field in Edge 14942\n        if (transceiver.kind === 'video'\n            && transceiver.recvEncodingParameters) {\n          transceiver.recvEncodingParameters.forEach(function(p) {\n            delete p.rtx;\n          });\n        }\n        params.encodings = transceiver.recvEncodingParameters;\n        params.rtcp = {\n          cname: transceiver.cname\n        };\n        if (transceiver.sendEncodingParameters.length) {\n          params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n        }\n        transceiver.rtpReceiver.receive(params);\n      }\n    };\n\n    window.RTCPeerConnection.prototype.setLocalDescription =\n        function(description) {\n          var self = this;\n          var sections;\n          var sessionpart;\n          if (description.type === 'offer') {\n            // FIXME: What was the purpose of this empty if statement?\n            // if (!this._pendingOffer) {\n            // } else {\n            if (this._pendingOffer) {\n              // VERY limited support for SDP munging. Limited to:\n              // * changing the order of codecs\n              sections = SDPUtils.splitSections(description.sdp);\n              sessionpart = sections.shift();\n              sections.forEach(function(mediaSection, sdpMLineIndex) {\n                var caps = SDPUtils.parseRtpParameters(mediaSection);\n                self._pendingOffer[sdpMLineIndex].localCapabilities = caps;\n              });\n              this.transceivers = this._pendingOffer;\n              delete this._pendingOffer;\n            }\n          } else if (description.type === 'answer') {\n            sections = SDPUtils.splitSections(self.remoteDescription.sdp);\n            sessionpart = sections.shift();\n            var isIceLite = SDPUtils.matchPrefix(sessionpart,\n                'a=ice-lite').length > 0;\n            sections.forEach(function(mediaSection, sdpMLineIndex) {\n              var transceiver = self.transceivers[sdpMLineIndex];\n              var iceGatherer = transceiver.iceGatherer;\n              var iceTransport = transceiver.iceTransport;\n              var dtlsTransport = transceiver.dtlsTransport;\n              var localCapabilities = transceiver.localCapabilities;\n              var remoteCapabilities = transceiver.remoteCapabilities;\n\n              var rejected = mediaSection.split('\\n', 1)[0]\n                  .split(' ', 2)[1] === '0';\n\n              if (!rejected && !transceiver.isDatachannel) {\n                var remoteIceParameters = SDPUtils.getIceParameters(\n                    mediaSection, sessionpart);\n                if (isIceLite) {\n                  var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n                  .map(function(cand) {\n                    return SDPUtils.parseCandidate(cand);\n                  })\n                  .filter(function(cand) {\n                    return cand.component === '1';\n                  });\n                  // ice-lite only includes host candidates in the SDP so we can\n                  // use setRemoteCandidates (which implies an\n                  // RTCIceCandidateComplete)\n                  if (cands.length) {\n                    iceTransport.setRemoteCandidates(cands);\n                  }\n                }\n                var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n                    mediaSection, sessionpart);\n                if (isIceLite) {\n                  remoteDtlsParameters.role = 'server';\n                }\n\n                if (!self.usingBundle || sdpMLineIndex === 0) {\n                  iceTransport.start(iceGatherer, remoteIceParameters,\n                      isIceLite ? 'controlling' : 'controlled');\n                  dtlsTransport.start(remoteDtlsParameters);\n                }\n\n                // Calculate intersection of capabilities.\n                var params = self._getCommonCapabilities(localCapabilities,\n                    remoteCapabilities);\n\n                // Start the RTCRtpSender. The RTCRtpReceiver for this\n                // transceiver has already been started in setRemoteDescription.\n                self._transceive(transceiver,\n                    params.codecs.length > 0,\n                    false);\n              }\n            });\n          }\n\n          this.localDescription = {\n            type: description.type,\n            sdp: description.sdp\n          };\n          switch (description.type) {\n            case 'offer':\n              this._updateSignalingState('have-local-offer');\n              break;\n            case 'answer':\n              this._updateSignalingState('stable');\n              break;\n            default:\n              throw new TypeError('unsupported type \"' + description.type +\n                  '\"');\n          }\n\n          // If a success callback was provided, emit ICE candidates after it\n          // has been executed. Otherwise, emit callback after the Promise is\n          // resolved.\n          var hasCallback = arguments.length > 1 &&\n            typeof arguments[1] === 'function';\n          if (hasCallback) {\n            var cb = arguments[1];\n            window.setTimeout(function() {\n              cb();\n              if (self.iceGatheringState === 'new') {\n                self.iceGatheringState = 'gathering';\n              }\n              self._emitBufferedCandidates();\n            }, 0);\n          }\n          var p = Promise.resolve();\n          p.then(function() {\n            if (!hasCallback) {\n              if (self.iceGatheringState === 'new') {\n                self.iceGatheringState = 'gathering';\n              }\n              // Usually candidates will be emitted earlier.\n              window.setTimeout(self._emitBufferedCandidates.bind(self), 500);\n            }\n          });\n          return p;\n        };\n\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n        function(description) {\n          var self = this;\n          var stream = new MediaStream();\n          var receiverList = [];\n          var sections = SDPUtils.splitSections(description.sdp);\n          var sessionpart = sections.shift();\n          var isIceLite = SDPUtils.matchPrefix(sessionpart,\n              'a=ice-lite').length > 0;\n          this.usingBundle = SDPUtils.matchPrefix(sessionpart,\n              'a=group:BUNDLE ').length > 0;\n          sections.forEach(function(mediaSection, sdpMLineIndex) {\n            var lines = SDPUtils.splitLines(mediaSection);\n            var mline = lines[0].substr(2).split(' ');\n            var kind = mline[0];\n            var rejected = mline[1] === '0';\n            var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n\n            var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:');\n            if (mid.length) {\n              mid = mid[0].substr(6);\n            } else {\n              mid = SDPUtils.generateIdentifier();\n            }\n\n            // Reject datachannels which are not implemented yet.\n            if (kind === 'application' && mline[2] === 'DTLS/SCTP') {\n              self.transceivers[sdpMLineIndex] = {\n                mid: mid,\n                isDatachannel: true\n              };\n              return;\n            }\n\n            var transceiver;\n            var iceGatherer;\n            var iceTransport;\n            var dtlsTransport;\n            var rtpSender;\n            var rtpReceiver;\n            var sendEncodingParameters;\n            var recvEncodingParameters;\n            var localCapabilities;\n\n            var track;\n            // FIXME: ensure the mediaSection has rtcp-mux set.\n            var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n            var remoteIceParameters;\n            var remoteDtlsParameters;\n            if (!rejected) {\n              remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n                  sessionpart);\n              remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n                  sessionpart);\n              remoteDtlsParameters.role = 'client';\n            }\n            recvEncodingParameters =\n                SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n            var cname;\n            // Gets the first SSRC. Note that with RTX there might be multiple\n            // SSRCs.\n            var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n                .map(function(line) {\n                  return SDPUtils.parseSsrcMedia(line);\n                })\n                .filter(function(obj) {\n                  return obj.attribute === 'cname';\n                })[0];\n            if (remoteSsrc) {\n              cname = remoteSsrc.value;\n            }\n\n            var isComplete = SDPUtils.matchPrefix(mediaSection,\n                'a=end-of-candidates', sessionpart).length > 0;\n            var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n                .map(function(cand) {\n                  return SDPUtils.parseCandidate(cand);\n                })\n                .filter(function(cand) {\n                  return cand.component === '1';\n                });\n            if (description.type === 'offer' && !rejected) {\n              var transports = self.usingBundle && sdpMLineIndex > 0 ? {\n                iceGatherer: self.transceivers[0].iceGatherer,\n                iceTransport: self.transceivers[0].iceTransport,\n                dtlsTransport: self.transceivers[0].dtlsTransport\n              } : self._createIceAndDtlsTransports(mid, sdpMLineIndex);\n\n              if (isComplete) {\n                transports.iceTransport.setRemoteCandidates(cands);\n              }\n\n              localCapabilities = RTCRtpReceiver.getCapabilities(kind);\n\n              // filter RTX until additional stuff needed for RTX is implemented\n              // in adapter.js\n              localCapabilities.codecs = localCapabilities.codecs.filter(\n                  function(codec) {\n                    return codec.name !== 'rtx';\n                  });\n\n              sendEncodingParameters = [{\n                ssrc: (2 * sdpMLineIndex + 2) * 1001\n              }];\n\n              rtpReceiver = new RTCRtpReceiver(transports.dtlsTransport, kind);\n\n              track = rtpReceiver.track;\n              receiverList.push([track, rtpReceiver]);\n              // FIXME: not correct when there are multiple streams but that is\n              // not currently supported in this shim.\n              stream.addTrack(track);\n\n              // FIXME: look at direction.\n              if (self.localStreams.length > 0 &&\n                  self.localStreams[0].getTracks().length >= sdpMLineIndex) {\n                var localTrack;\n                if (kind === 'audio') {\n                  localTrack = self.localStreams[0].getAudioTracks()[0];\n                } else if (kind === 'video') {\n                  localTrack = self.localStreams[0].getVideoTracks()[0];\n                }\n                if (localTrack) {\n                  rtpSender = new RTCRtpSender(localTrack,\n                      transports.dtlsTransport);\n                }\n              }\n\n              self.transceivers[sdpMLineIndex] = {\n                iceGatherer: transports.iceGatherer,\n                iceTransport: transports.iceTransport,\n                dtlsTransport: transports.dtlsTransport,\n                localCapabilities: localCapabilities,\n                remoteCapabilities: remoteCapabilities,\n                rtpSender: rtpSender,\n                rtpReceiver: rtpReceiver,\n                kind: kind,\n                mid: mid,\n                cname: cname,\n                sendEncodingParameters: sendEncodingParameters,\n                recvEncodingParameters: recvEncodingParameters\n              };\n              // Start the RTCRtpReceiver now. The RTPSender is started in\n              // setLocalDescription.\n              self._transceive(self.transceivers[sdpMLineIndex],\n                  false,\n                  direction === 'sendrecv' || direction === 'sendonly');\n            } else if (description.type === 'answer' && !rejected) {\n              transceiver = self.transceivers[sdpMLineIndex];\n              iceGatherer = transceiver.iceGatherer;\n              iceTransport = transceiver.iceTransport;\n              dtlsTransport = transceiver.dtlsTransport;\n              rtpSender = transceiver.rtpSender;\n              rtpReceiver = transceiver.rtpReceiver;\n              sendEncodingParameters = transceiver.sendEncodingParameters;\n              localCapabilities = transceiver.localCapabilities;\n\n              self.transceivers[sdpMLineIndex].recvEncodingParameters =\n                  recvEncodingParameters;\n              self.transceivers[sdpMLineIndex].remoteCapabilities =\n                  remoteCapabilities;\n              self.transceivers[sdpMLineIndex].cname = cname;\n\n              if ((isIceLite || isComplete) && cands.length) {\n                iceTransport.setRemoteCandidates(cands);\n              }\n              if (!self.usingBundle || sdpMLineIndex === 0) {\n                iceTransport.start(iceGatherer, remoteIceParameters,\n                    'controlling');\n                dtlsTransport.start(remoteDtlsParameters);\n              }\n\n              self._transceive(transceiver,\n                  direction === 'sendrecv' || direction === 'recvonly',\n                  direction === 'sendrecv' || direction === 'sendonly');\n\n              if (rtpReceiver &&\n                  (direction === 'sendrecv' || direction === 'sendonly')) {\n                track = rtpReceiver.track;\n                receiverList.push([track, rtpReceiver]);\n                stream.addTrack(track);\n              } else {\n                // FIXME: actually the receiver should be created later.\n                delete transceiver.rtpReceiver;\n              }\n            }\n          });\n\n          this.remoteDescription = {\n            type: description.type,\n            sdp: description.sdp\n          };\n          switch (description.type) {\n            case 'offer':\n              this._updateSignalingState('have-remote-offer');\n              break;\n            case 'answer':\n              this._updateSignalingState('stable');\n              break;\n            default:\n              throw new TypeError('unsupported type \"' + description.type +\n                  '\"');\n          }\n          if (stream.getTracks().length) {\n            self.remoteStreams.push(stream);\n            window.setTimeout(function() {\n              var event = new Event('addstream');\n              event.stream = stream;\n              self.dispatchEvent(event);\n              if (self.onaddstream !== null) {\n                window.setTimeout(function() {\n                  self.onaddstream(event);\n                }, 0);\n              }\n\n              receiverList.forEach(function(item) {\n                var track = item[0];\n                var receiver = item[1];\n                var trackEvent = new Event('track');\n                trackEvent.track = track;\n                trackEvent.receiver = receiver;\n                trackEvent.streams = [stream];\n                self.dispatchEvent(event);\n                if (self.ontrack !== null) {\n                  window.setTimeout(function() {\n                    self.ontrack(trackEvent);\n                  }, 0);\n                }\n              });\n            }, 0);\n          }\n          if (arguments.length > 1 && typeof arguments[1] === 'function') {\n            window.setTimeout(arguments[1], 0);\n          }\n          return Promise.resolve();\n        };\n\n    window.RTCPeerConnection.prototype.close = function() {\n      this.transceivers.forEach(function(transceiver) {\n        /* not yet\n        if (transceiver.iceGatherer) {\n          transceiver.iceGatherer.close();\n        }\n        */\n        if (transceiver.iceTransport) {\n          transceiver.iceTransport.stop();\n        }\n        if (transceiver.dtlsTransport) {\n          transceiver.dtlsTransport.stop();\n        }\n        if (transceiver.rtpSender) {\n          transceiver.rtpSender.stop();\n        }\n        if (transceiver.rtpReceiver) {\n          transceiver.rtpReceiver.stop();\n        }\n      });\n      // FIXME: clean up tracks, local streams, remote streams, etc\n      this._updateSignalingState('closed');\n    };\n\n    // Update the signaling state.\n    window.RTCPeerConnection.prototype._updateSignalingState =\n        function(newState) {\n          this.signalingState = newState;\n          var event = new Event('signalingstatechange');\n          this.dispatchEvent(event);\n          if (this.onsignalingstatechange !== null) {\n            this.onsignalingstatechange(event);\n          }\n        };\n\n    // Determine whether to fire the negotiationneeded event.\n    window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded =\n        function() {\n          // Fire away (for now).\n          var event = new Event('negotiationneeded');\n          this.dispatchEvent(event);\n          if (this.onnegotiationneeded !== null) {\n            this.onnegotiationneeded(event);\n          }\n        };\n\n    // Update the connection state.\n    window.RTCPeerConnection.prototype._updateConnectionState = function() {\n      var self = this;\n      var newState;\n      var states = {\n        'new': 0,\n        closed: 0,\n        connecting: 0,\n        checking: 0,\n        connected: 0,\n        completed: 0,\n        failed: 0\n      };\n      this.transceivers.forEach(function(transceiver) {\n        states[transceiver.iceTransport.state]++;\n        states[transceiver.dtlsTransport.state]++;\n      });\n      // ICETransport.completed and connected are the same for this purpose.\n      states.connected += states.completed;\n\n      newState = 'new';\n      if (states.failed > 0) {\n        newState = 'failed';\n      } else if (states.connecting > 0 || states.checking > 0) {\n        newState = 'connecting';\n      } else if (states.disconnected > 0) {\n        newState = 'disconnected';\n      } else if (states.new > 0) {\n        newState = 'new';\n      } else if (states.connected > 0 || states.completed > 0) {\n        newState = 'connected';\n      }\n\n      if (newState !== self.iceConnectionState) {\n        self.iceConnectionState = newState;\n        var event = new Event('iceconnectionstatechange');\n        this.dispatchEvent(event);\n        if (this.oniceconnectionstatechange !== null) {\n          this.oniceconnectionstatechange(event);\n        }\n      }\n    };\n\n    window.RTCPeerConnection.prototype.createOffer = function() {\n      var self = this;\n      if (this._pendingOffer) {\n        throw new Error('createOffer called while there is a pending offer.');\n      }\n      var offerOptions;\n      if (arguments.length === 1 && typeof arguments[0] !== 'function') {\n        offerOptions = arguments[0];\n      } else if (arguments.length === 3) {\n        offerOptions = arguments[2];\n      }\n\n      var tracks = [];\n      var numAudioTracks = 0;\n      var numVideoTracks = 0;\n      // Default to sendrecv.\n      if (this.localStreams.length) {\n        numAudioTracks = this.localStreams[0].getAudioTracks().length;\n        numVideoTracks = this.localStreams[0].getVideoTracks().length;\n      }\n      // Determine number of audio and video tracks we need to send/recv.\n      if (offerOptions) {\n        // Reject Chrome legacy constraints.\n        if (offerOptions.mandatory || offerOptions.optional) {\n          throw new TypeError(\n              'Legacy mandatory/optional constraints not supported.');\n        }\n        if (offerOptions.offerToReceiveAudio !== undefined) {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n        if (offerOptions.offerToReceiveVideo !== undefined) {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n      if (this.localStreams.length) {\n        // Push local streams.\n        this.localStreams[0].getTracks().forEach(function(track) {\n          tracks.push({\n            kind: track.kind,\n            track: track,\n            wantReceive: track.kind === 'audio' ?\n                numAudioTracks > 0 : numVideoTracks > 0\n          });\n          if (track.kind === 'audio') {\n            numAudioTracks--;\n          } else if (track.kind === 'video') {\n            numVideoTracks--;\n          }\n        });\n      }\n      // Create M-lines for recvonly streams.\n      while (numAudioTracks > 0 || numVideoTracks > 0) {\n        if (numAudioTracks > 0) {\n          tracks.push({\n            kind: 'audio',\n            wantReceive: true\n          });\n          numAudioTracks--;\n        }\n        if (numVideoTracks > 0) {\n          tracks.push({\n            kind: 'video',\n            wantReceive: true\n          });\n          numVideoTracks--;\n        }\n      }\n\n      var sdp = SDPUtils.writeSessionBoilerplate();\n      var transceivers = [];\n      tracks.forEach(function(mline, sdpMLineIndex) {\n        // For each track, create an ice gatherer, ice transport,\n        // dtls transport, potentially rtpsender and rtpreceiver.\n        var track = mline.track;\n        var kind = mline.kind;\n        var mid = SDPUtils.generateIdentifier();\n\n        var transports = self.usingBundle && sdpMLineIndex > 0 ? {\n          iceGatherer: transceivers[0].iceGatherer,\n          iceTransport: transceivers[0].iceTransport,\n          dtlsTransport: transceivers[0].dtlsTransport\n        } : self._createIceAndDtlsTransports(mid, sdpMLineIndex);\n\n        var localCapabilities = RTCRtpSender.getCapabilities(kind);\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n        localCapabilities.codecs.forEach(function(codec) {\n          // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n          // by adding level-asymmetry-allowed=1\n          if (codec.name === 'H264' &&\n              codec.parameters['level-asymmetry-allowed'] === undefined) {\n            codec.parameters['level-asymmetry-allowed'] = '1';\n          }\n        });\n\n        var rtpSender;\n        var rtpReceiver;\n\n        // generate an ssrc now, to be used later in rtpSender.send\n        var sendEncodingParameters = [{\n          ssrc: (2 * sdpMLineIndex + 1) * 1001\n        }];\n        if (track) {\n          rtpSender = new RTCRtpSender(track, transports.dtlsTransport);\n        }\n\n        if (mline.wantReceive) {\n          rtpReceiver = new RTCRtpReceiver(transports.dtlsTransport, kind);\n        }\n\n        transceivers[sdpMLineIndex] = {\n          iceGatherer: transports.iceGatherer,\n          iceTransport: transports.iceTransport,\n          dtlsTransport: transports.dtlsTransport,\n          localCapabilities: localCapabilities,\n          remoteCapabilities: null,\n          rtpSender: rtpSender,\n          rtpReceiver: rtpReceiver,\n          kind: kind,\n          mid: mid,\n          sendEncodingParameters: sendEncodingParameters,\n          recvEncodingParameters: null\n        };\n      });\n      if (this.usingBundle) {\n        sdp += 'a=group:BUNDLE ' + transceivers.map(function(t) {\n          return t.mid;\n        }).join(' ') + '\\r\\n';\n      }\n      tracks.forEach(function(mline, sdpMLineIndex) {\n        var transceiver = transceivers[sdpMLineIndex];\n        sdp += SDPUtils.writeMediaSection(transceiver,\n            transceiver.localCapabilities, 'offer', self.localStreams[0]);\n      });\n\n      this._pendingOffer = transceivers;\n      var desc = new RTCSessionDescription({\n        type: 'offer',\n        sdp: sdp\n      });\n      if (arguments.length && typeof arguments[0] === 'function') {\n        window.setTimeout(arguments[0], 0, desc);\n      }\n      return Promise.resolve(desc);\n    };\n\n    window.RTCPeerConnection.prototype.createAnswer = function() {\n      var self = this;\n\n      var sdp = SDPUtils.writeSessionBoilerplate();\n      if (this.usingBundle) {\n        sdp += 'a=group:BUNDLE ' + this.transceivers.map(function(t) {\n          return t.mid;\n        }).join(' ') + '\\r\\n';\n      }\n      this.transceivers.forEach(function(transceiver) {\n        if (transceiver.isDatachannel) {\n          sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n' +\n              'c=IN IP4 0.0.0.0\\r\\n' +\n              'a=mid:' + transceiver.mid + '\\r\\n';\n          return;\n        }\n        // Calculate intersection of capabilities.\n        var commonCapabilities = self._getCommonCapabilities(\n            transceiver.localCapabilities,\n            transceiver.remoteCapabilities);\n\n        sdp += SDPUtils.writeMediaSection(transceiver, commonCapabilities,\n            'answer', self.localStreams[0]);\n      });\n\n      var desc = new RTCSessionDescription({\n        type: 'answer',\n        sdp: sdp\n      });\n      if (arguments.length && typeof arguments[0] === 'function') {\n        window.setTimeout(arguments[0], 0, desc);\n      }\n      return Promise.resolve(desc);\n    };\n\n    window.RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n      if (!candidate) {\n        this.transceivers.forEach(function(transceiver) {\n          transceiver.iceTransport.addRemoteCandidate({});\n        });\n      } else {\n        var mLineIndex = candidate.sdpMLineIndex;\n        if (candidate.sdpMid) {\n          for (var i = 0; i < this.transceivers.length; i++) {\n            if (this.transceivers[i].mid === candidate.sdpMid) {\n              mLineIndex = i;\n              break;\n            }\n          }\n        }\n        var transceiver = this.transceivers[mLineIndex];\n        if (transceiver) {\n          var cand = Object.keys(candidate.candidate).length > 0 ?\n              SDPUtils.parseCandidate(candidate.candidate) : {};\n          // Ignore Chrome's invalid candidates since Edge does not like them.\n          if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n            return;\n          }\n          // Ignore RTCP candidates, we assume RTCP-MUX.\n          if (cand.component !== '1') {\n            return;\n          }\n          // A dirty hack to make samples work.\n          if (cand.type === 'endOfCandidates') {\n            cand = {};\n          }\n          transceiver.iceTransport.addRemoteCandidate(cand);\n\n          // update the remoteDescription.\n          var sections = SDPUtils.splitSections(this.remoteDescription.sdp);\n          sections[mLineIndex + 1] += (cand.type ? candidate.candidate.trim()\n              : 'a=end-of-candidates') + '\\r\\n';\n          this.remoteDescription.sdp = sections.join('');\n        }\n      }\n      if (arguments.length > 1 && typeof arguments[1] === 'function') {\n        window.setTimeout(arguments[1], 0);\n      }\n      return Promise.resolve();\n    };\n\n    window.RTCPeerConnection.prototype.getStats = function() {\n      var promises = [];\n      this.transceivers.forEach(function(transceiver) {\n        ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n            'dtlsTransport'].forEach(function(method) {\n              if (transceiver[method]) {\n                promises.push(transceiver[method].getStats());\n              }\n            });\n      });\n      var cb = arguments.length > 1 && typeof arguments[1] === 'function' &&\n          arguments[1];\n      return new Promise(function(resolve) {\n        // shim getStats with maplike support\n        var results = new Map();\n        Promise.all(promises).then(function(res) {\n          res.forEach(function(result) {\n            Object.keys(result).forEach(function(id) {\n              results.set(id, result[id]);\n              results[id] = result[id];\n            });\n          });\n          if (cb) {\n            window.setTimeout(cb, 0, results);\n          }\n          resolve(results);\n        });\n      });\n    };\n  }\n};\n\n// Expose public methods.\nmodule.exports = {\n  shimPeerConnection: edgeShim.shimPeerConnection,\n  shimGetUserMedia: require('./getusermedia')\n};\n"," /* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parts[1],\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress); // was: relAddr\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort); // was: relPort\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n}\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  // was: channels\n  parsed.numChannels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (codec.numChannels !== 1 ? '/' + codec.numChannels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n          ? '/' + headerExtension.direction\n          : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      params.push(param + '=' + codec.parameters[param]);\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n}\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n      'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  // Search in session part, too.\n  lines = lines.concat(SDPUtils.splitLines(sessionpart));\n  var iceParameters = {\n    usernameFragment: lines.filter(function(line) {\n      return line.indexOf('a=ice-ufrag:') === 0;\n    })[0].substr(12),\n    password: lines.filter(function(line) {\n      return line.indexOf('a=ice-pwd:') === 0;\n    })[0].substr(10)\n  };\n  return iceParameters;\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n          mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n          mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  caps.headerExtensions.forEach(function(extension) {\n    sdp += SDPUtils.writeExtmap(extension);\n  });\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'cname';\n  });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n  .map(function(line) {\n    var parts = line.split(' ');\n    parts.shift();\n    return parts.map(function(part) {\n      return parseInt(part, 10);\n    });\n  });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10),\n        rtx: {\n          ssrc: secondarySsrc\n        }\n      };\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: secondarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(5), 10);\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  var cname;\n  // Gets the first SSRC. Note that with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n      .map(function(line) {\n        return SDPUtils.parseSsrcMedia(line);\n      })\n      .filter(function(obj) {\n        return obj.attribute === 'cname';\n      })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'msid';\n  });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\nSDPUtils.writeSessionBoilerplate = function() {\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\n// Expose public methods.\nmodule.exports = SDPUtils;\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\n// Expose public methods.\nmodule.exports = function() {\n  var shimError_ = function(e) {\n    return {\n      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString: function() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function(c) {\n    return origGetUserMedia(c).catch(function(e) {\n      return Promise.reject(shimError_(e));\n    });\n  };\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar browserDetails = require('../utils').browserDetails;\n\nvar firefoxShim = {\n  shimOnTrack: function() {\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n        window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function() {\n          return this._ontrack;\n        },\n        set: function(f) {\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n            this.removeEventListener('addstream', this._ontrackpoly);\n          }\n          this.addEventListener('track', this._ontrack = f);\n          this.addEventListener('addstream', this._ontrackpoly = function(e) {\n            e.stream.getTracks().forEach(function(track) {\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = {track: track};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            }.bind(this));\n          }.bind(this));\n        }\n      });\n    }\n  },\n\n  shimSourceObject: function() {\n    // Firefox has supported mozSrcObject since FF22, unprefixed in 42.\n    if (typeof window === 'object') {\n      if (window.HTMLMediaElement &&\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n          get: function() {\n            return this.mozSrcObject;\n          },\n          set: function(stream) {\n            this.mozSrcObject = stream;\n          }\n        });\n      }\n    }\n  },\n\n  shimPeerConnection: function() {\n    if (typeof window !== 'object' || !(window.RTCPeerConnection ||\n        window.mozRTCPeerConnection)) {\n      return; // probably media.peerconnection.enabled=false in about:config\n    }\n    // The RTCPeerConnection object.\n    if (!window.RTCPeerConnection) {\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        if (browserDetails.version < 38) {\n          // .urls is not supported in FF < 38.\n          // create RTCIceServers with a single url.\n          if (pcConfig && pcConfig.iceServers) {\n            var newIceServers = [];\n            for (var i = 0; i < pcConfig.iceServers.length; i++) {\n              var server = pcConfig.iceServers[i];\n              if (server.hasOwnProperty('urls')) {\n                for (var j = 0; j < server.urls.length; j++) {\n                  var newServer = {\n                    url: server.urls[j]\n                  };\n                  if (server.urls[j].indexOf('turn') === 0) {\n                    newServer.username = server.username;\n                    newServer.credential = server.credential;\n                  }\n                  newIceServers.push(newServer);\n                }\n              } else {\n                newIceServers.push(pcConfig.iceServers[i]);\n              }\n            }\n            pcConfig.iceServers = newIceServers;\n          }\n        }\n        return new mozRTCPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype = mozRTCPeerConnection.prototype;\n\n      // wrap static methods. Currently just generateCertificate.\n      if (mozRTCPeerConnection.generateCertificate) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function() {\n            return mozRTCPeerConnection.generateCertificate;\n          }\n        });\n      }\n\n      window.RTCSessionDescription = mozRTCSessionDescription;\n      window.RTCIceCandidate = mozRTCIceCandidate;\n    }\n\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          var nativeMethod = RTCPeerConnection.prototype[method];\n          RTCPeerConnection.prototype[method] = function() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                RTCIceCandidate : RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          };\n        });\n\n    // support for addIceCandidate(null or undefined)\n    var nativeAddIceCandidate =\n        RTCPeerConnection.prototype.addIceCandidate;\n    RTCPeerConnection.prototype.addIceCandidate = function() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n\n    if (browserDetails.version < 48) {\n      // shim getStats with maplike support\n      var makeMapStats = function(stats) {\n        var map = new Map();\n        Object.keys(stats).forEach(function(key) {\n          map.set(key, stats[key]);\n          map[key] = stats[key];\n        });\n        return map;\n      };\n\n      var nativeGetStats = RTCPeerConnection.prototype.getStats;\n      RTCPeerConnection.prototype.getStats = function(selector, onSucc, onErr) {\n        return nativeGetStats.apply(this, [selector || null])\n          .then(function(stats) {\n            return makeMapStats(stats);\n          })\n          .then(onSucc, onErr);\n      };\n    }\n  }\n};\n\n// Expose public methods.\nmodule.exports = {\n  shimOnTrack: firefoxShim.shimOnTrack,\n  shimSourceObject: firefoxShim.shimSourceObject,\n  shimPeerConnection: firefoxShim.shimPeerConnection,\n  shimGetUserMedia: require('./getusermedia')\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar logging = require('../utils').log;\nvar browserDetails = require('../utils').browserDetails;\n\n// Expose public methods.\nmodule.exports = function() {\n  var shimError_ = function(e) {\n    return {\n      name: {\n        SecurityError: 'NotAllowedError',\n        PermissionDeniedError: 'NotAllowedError'\n      }[e.name] || e.name,\n      message: {\n        'The operation is insecure.': 'The request is not allowed by the ' +\n        'user agent or the platform in the current context.'\n      }[e.message] || e.message,\n      constraint: e.constraint,\n      toString: function() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  // getUserMedia constraints shim.\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\n    var constraintsToFF37_ = function(c) {\n      if (typeof c !== 'object' || c.require) {\n        return c;\n      }\n      var require = [];\n      Object.keys(c).forEach(function(key) {\n        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n          return;\n        }\n        var r = c[key] = (typeof c[key] === 'object') ?\n            c[key] : {ideal: c[key]};\n        if (r.min !== undefined ||\n            r.max !== undefined || r.exact !== undefined) {\n          require.push(key);\n        }\n        if (r.exact !== undefined) {\n          if (typeof r.exact === 'number') {\n            r. min = r.max = r.exact;\n          } else {\n            c[key] = r.exact;\n          }\n          delete r.exact;\n        }\n        if (r.ideal !== undefined) {\n          c.advanced = c.advanced || [];\n          var oc = {};\n          if (typeof r.ideal === 'number') {\n            oc[key] = {min: r.ideal, max: r.ideal};\n          } else {\n            oc[key] = r.ideal;\n          }\n          c.advanced.push(oc);\n          delete r.ideal;\n          if (!Object.keys(r).length) {\n            delete c[key];\n          }\n        }\n      });\n      if (require.length) {\n        c.require = require;\n      }\n      return c;\n    };\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (browserDetails.version < 38) {\n      logging('spec: ' + JSON.stringify(constraints));\n      if (constraints.audio) {\n        constraints.audio = constraintsToFF37_(constraints.audio);\n      }\n      if (constraints.video) {\n        constraints.video = constraintsToFF37_(constraints.video);\n      }\n      logging('ff37: ' + JSON.stringify(constraints));\n    }\n    return navigator.mozGetUserMedia(constraints, onSuccess, function(e) {\n      onError(shimError_(e));\n    });\n  };\n\n  // Returns the result of getUserMedia as a Promise.\n  var getUserMediaPromise_ = function(constraints) {\n    return new Promise(function(resolve, reject) {\n      getUserMedia_(constraints, resolve, reject);\n    });\n  };\n\n  // Shim for mediaDevices on older versions.\n  if (!navigator.mediaDevices) {\n    navigator.mediaDevices = {getUserMedia: getUserMediaPromise_,\n      addEventListener: function() { },\n      removeEventListener: function() { }\n    };\n  }\n  navigator.mediaDevices.enumerateDevices =\n      navigator.mediaDevices.enumerateDevices || function() {\n        return new Promise(function(resolve) {\n          var infos = [\n            {kind: 'audioinput', deviceId: 'default', label: '', groupId: ''},\n            {kind: 'videoinput', deviceId: 'default', label: '', groupId: ''}\n          ];\n          resolve(infos);\n        });\n      };\n\n  if (browserDetails.version < 41) {\n    // Work around http://bugzil.la/1169665\n    var orgEnumerateDevices =\n        navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);\n    navigator.mediaDevices.enumerateDevices = function() {\n      return orgEnumerateDevices().then(undefined, function(e) {\n        if (e.name === 'NotFoundError') {\n          return [];\n        }\n        throw e;\n      });\n    };\n  }\n  if (browserDetails.version < 49) {\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      return origGetUserMedia(c).then(function(stream) {\n        // Work around https://bugzil.la/802326\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(function(track) {\n            track.stop();\n          });\n          throw new DOMException('The object can not be found here.',\n                                 'NotFoundError');\n        }\n        return stream;\n      }, function(e) {\n        return Promise.reject(shimError_(e));\n      });\n    };\n  }\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    if (browserDetails.version < 44) {\n      return getUserMedia_(constraints, onSuccess, onError);\n    }\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    console.warn('navigator.getUserMedia has been replaced by ' +\n                 'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nvar safariShim = {\n  // TODO: DrAlex, should be here, double check against LayoutTests\n  // shimOnTrack: function() { },\n\n  // TODO: once the back-end for the mac port is done, add.\n  // TODO: check for webkitGTK+\n  // shimPeerConnection: function() { },\n\n  shimGetUserMedia: function() {\n    navigator.getUserMedia = navigator.webkitGetUserMedia;\n  }\n};\n\n// Expose public methods.\nmodule.exports = {\n  shimGetUserMedia: safariShim.shimGetUserMedia\n  // TODO\n  // shimOnTrack: safariShim.shimOnTrack,\n  // shimPeerConnection: safariShim.shimPeerConnection\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n'use strict';\n\n// Shimming starts here.\n(function() {\n  // Utils.\n  var logging = require('./utils').log;\n  var browserDetails = require('./utils').browserDetails;\n  // Export to the adapter global object visible in the browser.\n  module.exports.browserDetails = browserDetails;\n  module.exports.extractVersion = require('./utils').extractVersion;\n  module.exports.disableLog = require('./utils').disableLog;\n\n  // Uncomment the line below if you want logging to occur, including logging\n  // for the switch statement below. Can also be turned on in the browser via\n  // adapter.disableLog(false), but then logging from the switch statement below\n  // will not appear.\n  // require('./utils').disableLog(false);\n\n  // Browser shims.\n  var chromeShim = require('./chrome/chrome_shim') || null;\n  var edgeShim = require('./edge/edge_shim') || null;\n  var firefoxShim = require('./firefox/firefox_shim') || null;\n  var safariShim = require('./safari/safari_shim') || null;\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'opera': // fallthrough as it uses chrome shims\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection) {\n        logging('Chrome shim is not included in this adapter release.');\n        return;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      module.exports.browserShim = chromeShim;\n\n      chromeShim.shimGetUserMedia();\n      chromeShim.shimMediaStream();\n      chromeShim.shimSourceObject();\n      chromeShim.shimPeerConnection();\n      chromeShim.shimOnTrack();\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection) {\n        logging('Firefox shim is not included in this adapter release.');\n        return;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      module.exports.browserShim = firefoxShim;\n\n      firefoxShim.shimGetUserMedia();\n      firefoxShim.shimSourceObject();\n      firefoxShim.shimPeerConnection();\n      firefoxShim.shimOnTrack();\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection) {\n        logging('MS edge shim is not included in this adapter release.');\n        return;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      module.exports.browserShim = edgeShim;\n\n      edgeShim.shimGetUserMedia();\n      edgeShim.shimPeerConnection();\n      break;\n    case 'safari':\n      if (!safariShim) {\n        logging('Safari shim is not included in this adapter release.');\n        return;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      module.exports.browserShim = safariShim;\n\n      safariShim.shimGetUserMedia();\n      break;\n    default:\n      logging('Unsupported browser!');\n  }\n})();\n","// getUserMedia helper by @HenrikJoreteg used for navigator.getUserMedia shim\nvar adapter = require('webrtc-adapter');\n\nmodule.exports = function (constraints, cb) {\n    var error;\n    var haveOpts = arguments.length === 2;\n    var defaultOpts = {video: true, audio: true};\n\n    var denied = 'PermissionDeniedError';\n    var altDenied = 'PERMISSION_DENIED';\n    var notSatisfied = 'ConstraintNotSatisfiedError';\n\n    // make constraints optional\n    if (!haveOpts) {\n        cb = constraints;\n        constraints = defaultOpts;\n    }\n\n    // treat lack of browser support like an error\n    if (typeof navigator === 'undefined' || !navigator.getUserMedia) {\n        // throw proper error per spec\n        error = new Error('MediaStreamError');\n        error.name = 'NotSupportedError';\n\n        // keep all callbacks async\n        return setTimeout(function () {\n            cb(error);\n        }, 0);\n    }\n\n    // normalize error handling when no media types are requested\n    if (!constraints.audio && !constraints.video) {\n        error = new Error('MediaStreamError');\n        error.name = 'NoMediaRequestedError';\n\n        // keep all callbacks async\n        return setTimeout(function () {\n            cb(error);\n        }, 0);\n    }\n\n    navigator.mediaDevices.getUserMedia(constraints)\n    .then(function (stream) {\n        cb(null, stream);\n    }).catch(function (err) {\n        var error;\n        // coerce into an error object since FF gives us a string\n        // there are only two valid names according to the spec\n        // we coerce all non-denied to \"constraint not satisfied\".\n        if (typeof err === 'string') {\n            error = new Error('MediaStreamError');\n            if (err === denied || err === altDenied) {\n                error.name = denied;\n            } else {\n                error.name = notSatisfied;\n            }\n        } else {\n            // if we get an error object make sure '.name' property is set\n            // according to spec: http://dev.w3.org/2011/webrtc/editor/getusermedia.html#navigatorusermediaerror-and-navigatorusermediaerrorcallback\n            error = err;\n            if (!error.name) {\n                // this is likely chrome which\n                // sets a property called \"ERROR_DENIED\" on the error object\n                // if so we make sure to set a name\n                if (error[denied]) {\n                    err.name = denied;\n                } else {\n                    err.name = notSatisfied;\n                }\n            }\n        }\n\n        cb(error);\n    });\n};\n","/**\n * The 3 vertices of a 2D triangle covering the viewport in NDC coordinates ([-1, 1]).\n *\n * @export\n * @type {array.<array.<number>>}\n */\nexport const vertices = [[-1, -1], [-1, 4], [4, -1]];\n\nexport const count = vertices.length;\nexport const dim = 2;\n\n/**\n * The flat array of the above triangle, to be bound as a WebGL attribute buffer for\n * rendering the triangle in the vertex shader.\n * These positions will result in clipped NDC coordinates ([-1, 1]) over the\n * viewport's width and height.\n *\n * @export\n * @type {array.<number>}\n */\nexport const positions = vertices.flat();\n\nexport default positions;\n","/**\n * Creates an iterable array of the given length of empty entries, or\n * those given by optional arguments to `Array.fill`.\n *\n * @see Array.fill\n *\n * @param {number} n The number of elements to create.\n * @param {*} [value] A value to fill the array with; for `Array.fill`.\n * @param {number} [start=0] Start index, inclusive; for `Array.fill`.\n * @param {number} [end=n] End index, exclusive; for `Array.fill`.\n *\n * @returns {array} An array of the given number of empty elements.\n */\nexport const range = (n, value, start, end) => Array(n).fill(value, start, end);\n\nexport default range;\n","const r = Array.prototype.reduce;\n\n/**\n * Reduce an array-like object.\n * Similar to native, but with iteratee-first arguments.\n * Supports the native single-argument behaviour.\n *\n * @param {function} f The iteratee function, given standard arguments, plus the\n *     `out` argument.\n * @param {array} a The list to reduce over (array or array-like object).\n * @param {*} [out] The initial accumulator, if given; otherwise, uses standard\n *     `Array.reduce` behaviour.\n *\n * @returns {*} The result of running the reducer iteratee function over all\n *     elements of the list.\n */\nexport const reduce = (f, a, out) =>\n    // Needs separate `call` because native detects even `undefined` parameter.\n    ((out === undefined)? r.call(a, f) : r.call(a, f, out));\n\nexport default reduce;\n","import { reduce } from './reduce';\n\n/**\n * Map an array-like object.\n * Similar to native, but with iteratee-first arguments; and allows the object\n * into which properties will be mapped to be defined (a new array, by default),\n * avoiding always creating new arrays.\n *\n * @param {function} f The iteratee function, given standard `Array.map`\n *     arguments, plus the output object.\n * @param {array} a The list to map over (array or array-like object).\n * @param {*} [out=[]] The initial accumulator, if given; `a` if falsey given;\n *     or a new array if not given.\n *\n * @returns {*} The result of mapping `out` through the iteratee function over\n *     the `a` list.\n */\nexport const map = (f, a, out = []) => reduce((out, v, i) => {\n        out[i] = f(v, i, a, out);\n\n        return out;\n    },\n    a, (out || a));\n\nexport default map;\n","const e = Array.prototype.forEach;\n\n/**\n * Iterates a function over every element of a list, returning the list.\n *\n * @param {function} f The iteratee function.\n * @param {array} a A list to iterate over (array or array-like object).\n *\n * @returns {array} The given list.\n */\nexport const each = (f, a) => {\n    e.call(a, f);\n\n    return a;\n}\n\nexport default each;\n","/**\n * Wraps an index within a given length, so that indexes greater than the length\n * loop back past 0, and indexes less than 0 loop backward from the length.\n * Similar to the indexing behaviour of `Array.slice`.\n *\n * @param {number} i The index to wrap.\n * @param {number} l The length to wrap the index within.\n *\n * @returns {number} The index wrapped within the length.\n */\nexport const wrapIndex = (i, l) => ((i%l)+l)%l;\n\n/**\n * Gives the entry at a wrapped index of a given list, never exceeds its bounds.\n *\n * @see wrapIndex\n *\n * @param {number} i The index to wrap.\n * @param {array} a A list to index (array or array-like object).\n * @param {number} a.length The length property of the given list.\n *\n * @returns {*} The entry at the wrapped index of the given list.\n */\nexport const wrapGet = (i, a) => a[wrapIndex(i, a.length)];\n\nexport const wrap = { index: wrapIndex, get: wrapGet };\n\nexport default wrap;\n","/**\n * Optical flow fragment shader, for convenience.\n *\n * @see ./index.frag\n */\n\n// #define opticalFlowMap\n\nprecision highp float;\n\nuniform sampler2D next;\nuniform sampler2D past;\nuniform float offset;\nuniform float lambda;\nuniform float alpha;\nuniform vec2 speed;\n\n// Optionally map the flow ([-1, 1]) to a different range (e.g: [0, 1]).\n#ifdef opticalFlowMap\n  uniform vec4 inRange;\n  uniform vec4 outRange;\n\n  #pragma glslify: map = require(glsl-map)\n#endif\n\nvarying vec2 uv;\n\n#pragma glslify: opticalFlow = require(./index)\n\nvoid main() {\n  vec2 flow = opticalFlow(uv, next, past, offset, lambda);\n  float power = dot(flow, flow);\n\n  flow *= speed;\n\n  // Optionally map the flow ([-1, 1]) to a different range (e.g: [0, 1]).\n  #ifdef opticalFlowMap\n    flow = map(flow, inRange.xy, inRange.zw, outRange.xy, outRange.zw);\n  #endif\n\n  gl_FragColor = vec4(flow, power, clamp(power*alpha, 0.0, 1.0));\n}\n","// Perform a `blur`.\n// #define opticalFlowSpreadBlur\n\n// Scale values output by a `tint`.\n// #define opticalFlowSpreadTint\n\n// Shift the sample lookup by a `flow` lookup.\n#define opticalFlowSpreadShift_none 0\n#define opticalFlowSpreadShift_frame 1\n#define opticalFlowSpreadShift_flow 2\n#ifndef opticalFlowSpreadShift\n  #define opticalFlowSpreadShift opticalFlowSpreadShift_none\n#endif\n\n// Map any flow values.\n// #define opticalFlowSpreadMap\n\n// Blend with past frame.\n// #define opticalFlowSpreadBlend\n\nprecision highp float;\n\nuniform sampler2D frame;\n\n// Perform a `blur`.\n#ifdef opticalFlowSpreadBlur\n  uniform vec2 axis;\n  uniform float width;\n  uniform float height;\n#endif\n\n// Alter the values output, scaling by a `tint`.\n#ifdef opticalFlowSpreadTint\n  uniform vec4 tint;\n#endif\n\n#if opticalFlowSpreadShift != opticalFlowSpreadShift_none\n  // Shift the sample lookup by a `flow` lookup.\n  uniform vec2 speed;\n\n  // Use a separate `flow` input.\n  #if opticalFlowSpreadShift == opticalFlowSpreadShift_flow\n    uniform sampler2D flow;\n  #endif\n\n  // Map any flow values.\n  #ifdef opticalFlowSpreadMap\n    uniform vec4 inRange;\n    uniform vec4 toRange;\n\n    #pragma glslify: map = require(glsl-map)\n  #endif\n#endif\n\n#ifdef opticalFlowSpreadBlend\n  uniform sampler2D other;\n  uniform float blend;\n#endif\n\nvarying vec2 uv;\n\n#pragma glslify: blur = require(glsl-fast-gaussian-blur/5)\n\n#if opticalFlowSpreadShift != opticalFlowSpreadShift_none\n  vec2 shift(vec2 uv, sampler2D flow) {\n    vec2 f = texture2D(flow, uv).xy;\n\n    // Reverse any mapping of the flow values.\n    #ifdef opticalFlowSpreadMap\n      f = map(f, toRange.xy, toRange.zw, inRange.xy, inRange.zw);\n    #endif\n\n    return uv+(f*speed);\n  }\n#endif\n\nvoid main() {\n  vec2 st = uv;\n\n  // Shift the sample lookup by a `flow` lookup.\n  #if opticalFlowSpreadShift == opticalFlowSpreadShift_flow\n    // Use the given `flow` input.\n    st = shift(st, flow);\n  #elif opticalFlowSpreadShift == opticalFlowSpreadShift_frame\n    // Use the `frame` itself as `flow` input.\n    st = shift(st, frame);\n  #endif\n\n  // Perform a `blur`.\n  #ifdef opticalFlowSpreadBlur\n    vec4 c = blur(frame, st, vec2(width, height), axis);\n  #else\n    vec4 c = texture2D(frame, st);\n  #endif\n\n  // Map back to any given range.\n  #ifdef opticalFlowSpreadMap\n    c.xy = map(c.xy, toRange.xy, toRange.zw, inRange.xy, inRange.zw);\n  #endif\n\n  // Scale values output by `tint`.\n  #ifdef opticalFlowSpreadTint\n    c *= tint;\n  #endif\n\n  // Reverse any mapping.\n  #ifdef opticalFlowSpreadMap\n    c.xy = map(c.xy, inRange.xy, inRange.zw, toRange.xy, toRange.zw);\n  #endif\n\n  #ifdef opticalFlowSpreadBlend\n    vec4 o = texture2D(other, uv);\n\n    c = mix(c, o, mix(1.0-c.a, o.a, blend));\n  #endif\n\n  gl_FragColor = c;\n}\n","// Map any flow values.\n// #define opticalFlowViewMap\n\nprecision highp float;\n\nuniform sampler2D frame;\n\n// Map any flow values.\n#ifdef opticalFlowViewMap\n  uniform vec4 inRange;\n  uniform vec4 toRange;\n\n  #pragma glslify: map = require(glsl-map)\n#endif\n\nvarying vec2 uv;\n\n#pragma glslify: tau = require(glsl-constants/TWO_PI)\n#pragma glslify: hslToRGB = require(glsl-hsl2rgb)\n\nvoid main() {\n  vec4 data = texture2D(frame, uv);\n  float a = clamp(data.a, 0.0, 1.0);\n  vec2 flow = data.xy;\n\n  // Map any flow values.\n  #ifdef opticalFlowViewMap\n    flow = map(flow, toRange.xy, toRange.zw, inRange.xy, inRange.zw);\n  #endif\n\n  // Angle to hue - red right, green up, cyan left, magenta down.\n  vec3 color = hslToRGB(atan(flow.y, flow.x)/tau, 0.9*a, 0.6*a);\n\n  gl_FragColor = vec4(color, a);\n}\n","/** Any rendering library, but made with `regl` in mind. */\nimport getRegl from 'regl';\nimport getUserMedia from 'getusermedia';\nimport { positions, count } from '@epok.tech/gl-screen-triangle';\nimport range from '@epok.tech/fn-lists/range';\nimport map from '@epok.tech/fn-lists/map';\nimport each from '@epok.tech/fn-lists/each';\nimport { wrapIndex, wrapGet } from '@epok.tech/fn-lists/wrap-index';\n\nimport vert from '@epok.tech/gl-screen-triangle/uv-texture.vert.glsl';\nimport flowFrag from '../index.frag.glsl';\nimport spreadFrag from './spread.frag.glsl';\nimport viewFrag from './view.frag.glsl';\n\nconst $demo = document.querySelector('.demo');\nconst $video = $demo.querySelector('.webcam');\nconst $canvas = $demo.querySelector('.output');\nconst $fallback = document.querySelector('.fallback');\n\n// Handle query parameters.\nconst query = new URLSearchParams(location.search);\n\nconst regl = getRegl({\n  canvas: $canvas,\n  optionalExtensions: [\n    'oes_texture_half_float', 'oes_texture_float', 'oes_texture_float_linear'\n  ]\n});\n\nconst float = (regl.hasExtension('oes_texture_float_linear') &&\n  ((regl.hasExtension('oes_texture_float'))? 'float'\n  : regl.hasExtension('oes_texture_half_float') && 'half float'));\n\n// Whether to remap values between `float`/`int` in textures.\nconst remap = !float;\n\nconst mapProps = { type: float || 'uint8', min: 'linear', mag: 'linear' };\nconst frameProps = { width: 0, height: 0, depth: false, stencil: false };\n\nconst getMap = () => regl.texture(mapProps);\n\nconst getFrame = (color = getMap()) =>\n  regl.framebuffer({ color, ...frameProps });\n\n// Each blur axis of spread.\nconst spreadMaps = map(getMap, range(2), 0);\nconst spreadFrames = map(getFrame, spreadMaps);\n\n// Past and next video frames for optical-flow.\nconst flowFrames = map(() => getFrame(), range(2), 0);\nconst flowTo = getFrame();\n\n// Past and next optical-flow frames to blend.\nconst blendFrames = map(() => getFrame(), range(2), 0);\n\nconst resizers = [...spreadFrames, ...flowFrames, flowTo, ...blendFrames];\n\nconst inRange = [-1, -1, 1, 1];\nconst toRange = [0, 0, 1, 1];\n\nconst props = self.opticalFlow = {\n  videoFrame: { data: $video, flipY: true },\n  spreadVideo: {\n    /**\n     * Blur the video.\n     *\n     * @see drawSpreadVideoProps\n     */\n    frag: '#define opticalFlowSpreadBlur\\n'+spreadFrag,\n\n    /**\n     * The `passes` props array spreads blur one axis after the other.\n     * Blurs the first axis of the first frame into the next frame, then\n     * the last axis of that frame into the first frame.\n     *\n     * @see drawSpreadProps\n     */\n    passes: map((a, p) => ({ axis: a, pass: p }), [[1.4, 0], [0, 1.4]], 0)\n  },\n  flow: {\n    frag: ((remap)? '#define opticalFlowMap\\n' : '')+flowFrag,\n    // Pixels units; will divide `offset` by the video resolution later.\n    offset: 3, lambda: 1e-3, speed: range(2, 1), alpha: 100,\n    inRange, toRange,\n    to: flowTo\n  },\n  spreadFlow: {\n    /**\n     * Blur the past flow frames along each `axis`, shift/advect along\n     * the `flow` by `speed`, `tint` to weaken the past flow, `blend` in\n     * the next optical-flow frame.\n     *\n     * @see drawSpreadFlowProps\n     */\n    frag: '#define opticalFlowSpreadBlur\\n'+\n      '#define opticalFlowSpreadTint\\n'+\n      '#define opticalFlowSpreadShift opticalFlowSpreadShift_flow\\n'+\n      ((remap)? '#define opticalFlowSpreadMap\\n' : '')+\n      '#define opticalFlowSpreadBlend\\n'+\n      spreadFrag,\n\n    other: flowTo, blend: 1,\n    inRange, toRange,\n\n    /**\n     * Bear in mind each of the `passes` per-`axis` also apply the other\n     * `spread` inputs; some may be better to control per-`pass`, others\n     * across both.\n     *\n     * @see props.spreadVideo.passes\n     */\n    passes: map((o, p) => {\n        o.pass = p;\n\n        return o;\n      },\n      [\n        { axis: [3, 0], tint: range(4, 1), speed: range(2, 0) },\n        { axis: [0, 3], tint: range(4, 0.99), speed: range(2, 1) }\n      ],\n      0)\n  },\n  view: {\n    frag: ((remap)? '#define opticalFlowViewMap\\n' : '')+viewFrag,\n    inRange, toRange\n  }\n};\n\nconst clearView = { color: [0, 0, 0, 1], depth: 1, stencil: 0 };\nconst clearFlow = { ...clearView, framebuffer: flowTo };\n\nconst clearFlows = map((f) => ({ ...clearView, framebuffer: f }), flowFrames);\n\nconst clearSpreads = map((f) => ({ ...clearView, framebuffer: f }),\n  spreadFrames);\n\nconst clearBlends = map((f) => ({ ...clearView, framebuffer: f }), blendFrames);\n\nconst drawScreen = regl({\n  vert, attributes: { position: positions }, count, depth: { enable: false }\n});\n\n// Spread a frame `pass`; blur along an `axis`, shift by a `flow`, `blend`\n// with an `other` map; if given.\nconst drawSpread = regl({\n  frag: (_, p) => p.frag ?? spreadFrag,\n  uniforms: {\n    // Swap by `pass`; allow `frame` to override if given.\n    frame: (_, { pass: p = 0, frame: f }) => f ?? wrapGet(p+1, spreadFrames),\n    axis: regl.prop('axis'),\n    tint: regl.prop('tint'),\n    speed: regl.prop('speed'),\n    flow: regl.prop('flow'),\n    inRange: regl.prop('inRange'),\n    toRange: regl.prop('toRange'),\n    other: regl.prop('other'),\n    blend: regl.prop('blend'),\n    width: regl.context('drawingBufferWidth'),\n    height: regl.context('drawingBufferHeight')\n  },\n  // Swap by `pass`; allow `to` to  override `framebuffer` if given.\n  framebuffer: (_, { pass: p = 0, to }) => to ?? wrapGet(p, spreadFrames)\n});\n\n// Draws the 2 spread blur `passes` across both axes one after the other.\nconst drawSpreadProps = (props) =>\n  // Merge any common `props` into each of `props.passes`.\n  drawSpread(map((pass) => Object.assign(pass, props, pass), props.passes, 0));\n\n// Blur the input video's current frame, into the next flow input frame.\nfunction drawSpreadVideoProps(tick) {\n  const { videoFrame, spreadVideo } = props;\n  const f = wrapIndex(tick, flowFrames.length);\n\n  each(regl.clear, clearSpreads);\n  spreadMaps[1](videoFrame);\n\n  regl.clear(clearFlows[f]);\n  spreadVideo.passes[1].to = flowFrames[f];\n\n  return drawSpreadProps(spreadVideo);\n}\n\n// The main function of concern - optical flow of the last 2 video frames.\nconst drawFlow = regl({\n  frag: (_, { frag: f = flowFrag }) => f,\n  uniforms: {\n    next: (c) => wrapGet(c.tick, flowFrames),\n    past: (c) => wrapGet(c.tick+1, flowFrames),\n    offset: regl.prop('offset'),\n    lambda: regl.prop('lambda'),\n    speed: regl.prop('speed'),\n    alpha: regl.prop('alpha'),\n    inRange: regl.prop('inRange'),\n    toRange: regl.prop('toRange')\n  },\n  framebuffer: (_, p) => p.to ?? flowTo\n});\n\nfunction drawFlowProps() {\n  regl.clear(clearFlow);\n\n  return drawFlow(props.flow);\n}\n\n/**\n * Blur the past flow frames along each `axis`, shift/advect along the\n * `flow` by `speed`, `tint` to weaken the past flow, `blend` in the next\n * optical-flow frame.\n *\n * @see props.spreadFlow\n */\nfunction drawSpreadFlowProps(tick) {\n  const { spreadFlow } = props;\n  const { passes } = spreadFlow;\n\n  each(regl.clear, clearSpreads);\n  spreadFlow.flow = passes[0].frame = wrapGet(tick+1, blendFrames);\n\n  const b = wrapIndex(tick, blendFrames.length);\n\n  regl.clear(clearBlends[b]);\n  passes[1].to = blendFrames[b];\n\n  return drawSpreadProps(spreadFlow);\n}\n\n// Draw to the screen.\nconst drawView = regl({\n  frag: (_, p) => p.frag ?? viewFrag,\n  uniforms: {\n    frame: (c) => wrapGet(c.tick, blendFrames),\n    inRange: regl.prop('inRange'),\n    toRange: regl.prop('toRange')\n  },\n  framebuffer: (_, p) => p.to\n});\n\nfunction drawViewProps() {\n  regl.clear(clearView);\n\n  return drawView(props.view);\n}\n\n// All together now.\nfunction draw({ tick: t }) {\n  // Blur the input video's current frame.\n  drawSpreadVideoProps(t);\n  // Get the optical flow from the last 2 `video` frames.\n  drawFlowProps();\n  // Spread the past flow frame and blend with the next one.\n  drawSpreadFlowProps(t);\n  // Draw to the screen.\n  drawViewProps();\n}\n\nfunction setup() {\n  const { videoWidth: w, videoHeight: h } = $video;\n\n  $video.width = $canvas.width = w;\n  $video.height = $canvas.height = h;\n  each((r) => r.resize(w, h), resizers);\n  // Pixels units; divide `offset` by the video resolution.\n  props.flow.offset /= Math.max(w, h, 1e3);\n  $video.play();\n\n  // Fill the flow frames with the first frame.\n  drawScreen(() => {\n    drawSpreadVideoProps(0);\n    drawSpreadVideoProps(1);\n  });\n\n  // Start the main loop.\n  regl.frame(() => drawScreen(draw));\n\n  $video.removeEventListener('canplay', setup);\n}\n\n$video.addEventListener('canplay', setup);\n\nconst sampleURL = new URL('sample.mp4', import.meta.url);\n\n((query.get('camera') === 'false')? $video.src = sampleURL\n: getUserMedia({ video: true }, (e, stream) => {\n    if(e) {\n      return console.warn(e, 'Error getting webcam stream, using sample video',\n        $video.src = sampleURL);\n    }\n\n    (('srcObject' in $video)? $video.srcObject = stream\n    : $video.src = URL.createObjectURL(stream));\n\n    $demo.classList.add('mirror');\n  }));\n\n$demo.addEventListener('click', () => {\n  const c = $demo.classList;\n\n  c[(c.contains('overlay'))? 'remove' : 'add']('overlay');\n});\n\n$fallback && (query.get('fallback') !== 'false') &&\n  ($fallback.src = $fallback.dataset.src);\n","precision highp float;\n\nattribute vec2 position;\n\nvarying vec2 uv;\n\n// Translation for UV NDC to texture coordinates.\nconst vec2 offset = vec2(0.5);\n\nvoid main() {\n    uv = (position*0.5)+offset;\n    gl_Position = vec4(position, 0, 1);\n}\n","\"use strict\";\n\nvar bundleURL = {};\n\nfunction getBundleURLCached(id) {\n  var value = bundleURL[id];\n\n  if (!value) {\n    value = getBundleURL();\n    bundleURL[id] = value;\n  }\n\n  return value;\n}\n\nfunction getBundleURL() {\n  try {\n    throw new Error();\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n\n    if (matches) {\n      // The first two stack frames will be this function and getBundleURLCached.\n      // Use the 3rd one, which will be a runtime in the original bundle.\n      return getBaseURL(matches[2]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n} // TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\n\n\nfunction getOrigin(url) {\n  var matches = ('' + url).match(/(https?|file|ftp):\\/\\/[^/]+/);\n\n  if (!matches) {\n    throw new Error('Origin not found');\n  }\n\n  return matches[0];\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\nexports.getOrigin = getOrigin;","module.exports = require('./helpers/bundle-url').getBundleURL('7P4AG') + require('./helpers/bundle-manifest').resolve(\"5El74\");"],"names":["obj","key","value","Object","defineProperty","enumerable","configurable","writable","target","i","arguments","length","source","ownKeys","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","forEach","$c29af7d59dca4181$export$2e2bcd8739ae039","arr","Array","isArray","arr2","$f16c756dc4c6fcab$export$2e2bcd8739ae039","iter","Symbol","iterator","prototype","toString","call","from","$2830bf695bfc577b$export$2e2bcd8739ae039","TypeError","$af1ae7be731ea2e6$export$2e2bcd8739ae039","$710056e3be7f8586$export$6503ec6e8aabbaf","$710056e3be7f8586$export$f7ad0328861e2f03","$710056e3be7f8586$var$mapping","pairs","id","resolved","Error","parcelRequire","register","JSON","parse","$d97f85cd64715388$var$logDisabled_","$d97f85cd64715388$var$utils","disableLog","bool","log","window","console","apply","extractVersion","uastring","expr","pos","match","parseInt","detectBrowser","result","navigator","browser","mozGetUserMedia","version","this","userAgent","webkitGetUserMedia","webkitRTCPeerConnection","mediaDevices","module","exports","browserDetails","$a0afa2162bbbca85$var$chromeShim","shimMediaStream","MediaStream","webkitMediaStream","shimOnTrack","RTCPeerConnection","get","_ontrack","set","f","self","removeEventListener","_ontrackpoly","addEventListener","e","stream","te","event","Event","track","receiver","streams","dispatchEvent","getTracks","bind","shimSourceObject","HTMLMediaElement","_srcObject","src","URL","revokeObjectURL","createObjectURL","shimPeerConnection","pcConfig","pcConstraints","iceTransportPolicy","iceTransports","pc","origGetStats","getStats","selector","successCallback","errorCallback","args","fixChromeStats_","response","standardReport","report","standardStats","timestamp","type","names","name","stat","makeMapStats","stats","legacyStats","map","Map","successCallbackWrapper_","Promise","resolve","reject","then","generateCertificate","method","nativeMethod","opts","undefined","$a0afa2162bbbca85$require$browserDetails","promise","err","RTCIceCandidate","RTCSessionDescription","nativeAddIceCandidate","addIceCandidate","shimGetUserMedia","constraintsToChrome_","c","mandatory","optional","cc","r","ideal","exact","min","max","oldname_","prefix","charAt","toUpperCase","slice","oc","push","mix","advanced","shimConstraints_","constraints","func","stringify","audio","video","face","facingMode","getSupportedConstraints","enumerateDevices","devices","back","d","kind","find","label","toLowerCase","indexOf","deviceId","shimError_","PermissionDeniedError","ConstraintNotSatisfiedError","message","constraint","constraintName","getUserMedia","onSuccess","onError","getUserMediaPromise_","kinds","MediaStreamTrack","getSources","device","groupId","origGetUserMedia","cs","getAudioTracks","getVideoTracks","stop","DOMException","$f5f014c156147a31$var$edgeShim","RTCIceGatherer","origMSTEnabled","ev","enabled","config","_eventTarget","document","createDocumentFragment","onicecandidate","onaddstream","ontrack","onremovestream","onsignalingstatechange","oniceconnectionstatechange","onnegotiationneeded","ondatachannel","localStreams","remoteStreams","getLocalStreams","getRemoteStreams","localDescription","sdp","remoteDescription","signalingState","iceConnectionState","iceGatheringState","iceOptions","gatherPolicy","iceServers","usingBundle","bundlePolicy","server","urls","url","$f5f014c156147a31$require$browserDetails","_config","transceivers","_localIceCandidatesBuffer","_emitBufferedCandidates","sections","$21dEp","splitSections","candidate","j","sdpMLineIndex","join","every","transceiver","iceGatherer","state","getConfiguration","addStream","clonedStream","clone","idx","clonedTrack","_maybeFireNegotiationNeeded","removeStream","splice","getSenders","rtpSender","getReceivers","rtpReceiver","_getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","codecs","headerExtensions","fecMechanisms","lCodec","rCodec","clockRate","numChannels","Math","rtcpFeedback","fb","parameter","lHeaderExtension","rHeaderExtension","uri","_createIceAndDtlsTransports","mid","iceTransport","RTCIceTransport","onlocalcandidate","evt","sdpMid","cand","end","component","writeCandidate","complete","onicestatechange","_updateConnectionState","dtlsTransport","RTCDtlsTransport","ondtlsstatechange","onerror","_transceive","send","recv","params","encodings","sendEncodingParameters","rtcp","cname","localCName","recvEncodingParameters","ssrc","p","rtx","receive","setLocalDescription","description","sessionpart","_pendingOffer","shift","mediaSection","caps","parseRtpParameters","isIceLite","matchPrefix","split","isDatachannel","remoteIceParameters","getIceParameters","cands","parseCandidate","setRemoteCandidates","remoteDtlsParameters","getDtlsParameters","role","start","_updateSignalingState","hasCallback","cb","setTimeout","setRemoteDescription","receiverList","mline","splitLines","substr","rejected","direction","getDirection","generateIdentifier","parseRtpEncodingParameters","remoteSsrc","line","parseSsrcMedia","attribute","isComplete","addTrack","localTrack","transports","RTCRtpReceiver","getCapabilities","codec","RTCRtpSender","item","trackEvent","close","newState","states","new","closed","connecting","checking","connected","completed","failed","disconnected","createOffer","offerOptions","tracks","numAudioTracks","numVideoTracks","offerToReceiveAudio","offerToReceiveVideo","wantReceive","writeSessionBoilerplate","parameters","t","writeMediaSection","desc","createAnswer","mLineIndex","transceiver1","protocol","port","addRemoteCandidate","trim","promises","results","all","res","$17864388326fd8db$var$SDPUtils","random","blob","part","index","parts","foundation","substring","priority","ip","relatedAddress","relatedPort","tcpType","parseIceOptions","parseRtpMap","parsed","payloadType","writeRtpMap","pt","preferredPayloadType","parseExtmap","writeExtmap","headerExtension","preferredId","parseFmtp","kv","writeFmtp","param","parseRtcpFb","writeRtcpFb","lines","sp","colon","getMid","parseFingerprint","algorithm","fingerprints","writeDtlsParameters","setupType","fp","usernameFragment","password","writeIceParameters","rtpmapline","fmtps","writeRtpDescription","maxptime","extension","secondarySsrc","encodingParameters","hasRed","hasUlpfec","ssrcs","primarySsrc","flows","apt","encParam","codecPayloadType","fec","mechanism","bandwidth","maxBitrate","parseRtcpParameters","rtcpParameters","rsize","reducedSize","compound","mux","parseMsid","parts1","spec","planB","getLocalParameters","msid","getKind","isRejected","catch","$46aa6c15acb05f44$var$firefoxShim","mozSrcObject","mozRTCPeerConnection","$46aa6c15acb05f44$require$browserDetails","newIceServers","hasOwnProperty","newServer","username","credential","mozRTCSessionDescription","mozRTCIceCandidate","nativeGetStats","onSucc","onErr","SecurityError","getUserMedia_","constraintsToFF37_","require","$5a1682ac92d22a54$require$browserDetails","orgEnumerateDevices","warn","$4e924d11ed2beaa3$var$safariShim","logging","chromeShim","edgeShim","firefoxShim","safariShim","$bf5ff8173bd689b2$exports","error1","haveOpts","defaultOpts","denied","altDenied","notSatisfied","error","$097d2d6ba61fde6a$export$ba60520149d1328e","$097d2d6ba61fde6a$export$85b9a36db797e02b","$097d2d6ba61fde6a$export$878041e1e4cd4218","flat","$5ebc876929a0439f$export$2e2bcd8739ae039","n","fill","$ee5851911330bf41$var$r","reduce","$ee5851911330bf41$export$533b26079ad0b4b","a","out","$6d8e5906de1cf303$export$2e2bcd8739ae039","out1","v","$6f535731e26073af$var$e","$6f535731e26073af$export$2e2bcd8739ae039","$4ad49746d3e88695$export$acb6ab09ed1b7b8b","l","$4ad49746d3e88695$export$ea134dcc07e79c49","$336eccba6604c43f$exports","$572f4bc6c56e1449$exports","$c6f317d9a0f640a7$exports","_frag","_to","$e5e27940694a4f4d$var$$demo","querySelector","$e5e27940694a4f4d$var$$video","$e5e27940694a4f4d$var$$canvas","$e5e27940694a4f4d$var$$fallback","$e5e27940694a4f4d$var$query","URLSearchParams","location","search","$e5e27940694a4f4d$var$regl","$parcel$interopDefault","$2a263769c476450e$exports","canvas","optionalExtensions","$e5e27940694a4f4d$var$float","hasExtension","$e5e27940694a4f4d$var$remap","$e5e27940694a4f4d$var$mapProps","mag","$e5e27940694a4f4d$var$frameProps","width","height","depth","stencil","$e5e27940694a4f4d$var$getMap","texture","$e5e27940694a4f4d$var$getFrame","color","framebuffer","$6ff65e20dc745a42$export$2e2bcd8739ae039","$e5e27940694a4f4d$var$spreadMaps","$e5e27940694a4f4d$var$spreadFrames","$e5e27940694a4f4d$var$flowFrames","$e5e27940694a4f4d$var$flowTo","$e5e27940694a4f4d$var$blendFrames","$e5e27940694a4f4d$var$resizers","$ef466a0c186023fe$export$2e2bcd8739ae039","$e5e27940694a4f4d$var$inRange","$e5e27940694a4f4d$var$toRange","$e5e27940694a4f4d$var$props","opticalFlow","videoFrame","data","flipY","spreadVideo","frag","passes","axis","pass","flow","offset","lambda","speed","alpha","inRange","toRange","to","spreadFlow","other","blend","o","tint","view","$e5e27940694a4f4d$var$clearView","$e5e27940694a4f4d$var$clearFlow","$e5e27940694a4f4d$var$clearFlows","$e5e27940694a4f4d$var$clearSpreads","$e5e27940694a4f4d$var$clearBlends","$e5e27940694a4f4d$var$drawScreen","vert","attributes","position","count","enable","$e5e27940694a4f4d$var$drawSpread","_","uniforms","frame","tmp","prop","context","$e5e27940694a4f4d$var$drawSpreadProps","props","assign","$e5e27940694a4f4d$var$drawSpreadVideoProps","tick","clear","_frag1","$e5e27940694a4f4d$var$drawFlow","next","past","$e5e27940694a4f4d$var$drawView","$e5e27940694a4f4d$var$draw","b","$e5e27940694a4f4d$var$drawSpreadFlowProps","$e5e27940694a4f4d$var$setup","w","videoWidth","h","videoHeight","resize","play","$04b9e23785ece54c$export$bdfd709ae4826697","$04b9e23785ece54c$var$bundleURL","$04b9e23785ece54c$var$getBaseURL","replace","matches","stack","$04b9e23785ece54c$var$getBundleURL","$3ec3f5f6d4274d0a$exports","getBundleURL","$e5e27940694a4f4d$var$sampleURL","srcObject","classList","add","contains","dataset"],"version":3,"file":"index.3749c18b.js.map"}